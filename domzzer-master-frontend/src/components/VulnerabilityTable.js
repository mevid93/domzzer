import React, { useState } from 'react'
import { Link } from "react-router-dom"

import StyledTableRow from './StyledTableRow'
import StyledTableCell from './StyledTableCell'

import TableContainer from '@material-ui/core/TableContainer'
import Table from '@material-ui/core/Table'
import TableHead from '@material-ui/core/TableHead'
import TableBody from '@material-ui/core/TableBody'
import TablePagination from '@material-ui/core/TablePagination'

const VulnerabilityTable = ({ vulnerabilities }) => {
  const [page, setPage] = useState(0)
  const rowsPerPage = 10

  const emptyRows = rowsPerPage - Math.min(rowsPerPage, vulnerabilities.length - page * rowsPerPage);

  return (
    <TableContainer style={{ marginTop: 50 }}>
      <Table aria-label="simple table">
        <TableHead>
          <StyledTableRow>
            <StyledTableCell>ID</StyledTableCell>
            <StyledTableCell>Target browser</StyledTableCell>
            <StyledTableCell>Timestamp</StyledTableCell>
            <StyledTableCell>Status</StyledTableCell>
          </StyledTableRow>
        </TableHead>
        <TableBody>
          {vulnerabilities
            .slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage)
            .map(v =>
              <StyledTableRow key={v.id}>
                <StyledTableCell align="left"><Link to={`/vulnerabilities/${v.id}`}>{v.id}</Link></StyledTableCell>
                <StyledTableCell align="left">{v.targetBrowser}</StyledTableCell>
                <StyledTableCell align="left">{v.timestamp}</StyledTableCell>
                <StyledTableCell align="left">{v.status}</StyledTableCell>
              </StyledTableRow>
            )}
          {emptyRows > 0 && (
            <StyledTableRow style={{ height: 53 * emptyRows }}>
              <StyledTableCell colSpan={6} />
            </StyledTableRow>)}
        </TableBody>
      </Table>
      <TablePagination
        rowsPerPageOptions={[10]}
        component="div"
        count={vulnerabilities.length}
        rowsPerPage={10}
        page={page}
        onPageChange={(event, newPage) => setPage(newPage)}
      />
    </TableContainer >
  )
}

export default VulnerabilityTable